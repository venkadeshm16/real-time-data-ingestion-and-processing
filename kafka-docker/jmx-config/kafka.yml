hostPort: kafka:9998
rules:
# Specific LeaderCount metric
- pattern: "kafka.server<type=ReplicaManager, name=LeaderCount><>Value"
  name: kafka_server_replicamanager_leadercount
- pattern: "kafka.server<type=ReplicaManager, name=PartitionCount><>Value"
  name: kafka_server_replicamanager_partitioncount
- pattern: "kafka.server<type=ReplicaManager, name=UnderReplicatedPartitions><>Value"
  name: kafka_server_replicamanager_underreplicatedpartitions

# BrokerTopicMetrics - specific patterns for Count attributes
- pattern: "kafka.server<type=BrokerTopicMetrics, name=MessagesInPerSec><>Count"
  name: kafka_server_brokertopicmetrics_messagesin_total
- pattern: "kafka.server<type=BrokerTopicMetrics, name=MessagesInPerSec, topic=(.+)><>Count"
  name: kafka_server_brokertopicmetrics_messagesin_total
  labels:
    topic: "$1"
- pattern: "kafka.server<type=BrokerTopicMetrics, name=BytesInPerSec><>Count"
  name: kafka_server_brokertopicmetrics_bytesin_total
- pattern: "kafka.server<type=BrokerTopicMetrics, name=BytesInPerSec, topic=(.+)><>Count"
  name: kafka_server_brokertopicmetrics_bytesin_total
  labels:
    topic: "$1"
- pattern: "kafka.server<type=BrokerTopicMetrics, name=BytesOutPerSec><>Count"
  name: kafka_server_brokertopicmetrics_bytesout_total
- pattern: "kafka.server<type=BrokerTopicMetrics, name=BytesOutPerSec, topic=(.+)><>Count"
  name: kafka_server_brokertopicmetrics_bytesout_total
  labels:
    topic: "$1"

# Broker metrics - Count attributes
- pattern: "kafka.server<type=(.+), name=(.+)><>Count"
  name: kafka_server_$1_$2_total
- pattern: "kafka.server<type=(.+), name=(.+), topic=(.+)><>Count"
  name: kafka_server_$1_$2_total
  labels:
    topic: "$3"

# Broker metrics - Value attributes
- pattern: "kafka.server<type=(.+), name=(.+)><>Value"
  name: kafka_server_$1_$2
- pattern: "kafka.server<type=(.+), name=(.+), clientId=(.+)><>Value"
  name: kafka_server_$1_$2
  labels:
    clientId: "$3"
- pattern: "kafka.server<type=(.+), name=(.+), topic=(.+)><>Value"
  name: kafka_server_$1_$2
  labels:
    topic: "$3"
- pattern: "kafka.server<type=(.+), name=(.+), topic=(.+), partition=(.+)><>Value"
  name: kafka_server_$1_$2
  labels:
    topic: "$3"
    partition: "$4"

# Network metrics
- pattern: "kafka.network<type=(.+), name=(.+)><>Value"
  name: kafka_network_$1_$2
- pattern: "kafka.network<type=(.+), name=(.+), request=(.+)><>Value"
  name: kafka_network_$1_$2
  labels:
    request: "$3"

# Log metrics
- pattern: "kafka.log<type=(.+), name=(.+)><>Value"
  name: kafka_log_$1_$2
- pattern: "kafka.log<type=(.+), name=(.+), topic=(.+), partition=(.+)><>Value"
  name: kafka_log_$1_$2
  labels:
    topic: "$3"
    partition: "$4"

# Controller metrics
- pattern: "kafka.controller<type=(.+), name=(.+)><>Value"
  name: kafka_controller_$1_$2

# JVM metrics
- pattern: "java.lang<type=(.+), name=(.+)><>(.+)"
  name: jvm_$1_$3
  labels:
    name: "$2"
- pattern: "java.lang<type=(.+)><>(.+)"
  name: jvm_$1_$2

# Catch all remaining metrics
- pattern: ".*"